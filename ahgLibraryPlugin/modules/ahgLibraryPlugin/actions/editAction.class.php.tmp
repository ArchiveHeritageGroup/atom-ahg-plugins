
    protected function syncDisplayConfig(int $objectId): void
    {
        try {
            // Use a separate PDO connection to avoid transaction conflicts
            $config = include(sfConfig::get('sf_root_dir') . '/config/config.php');
            $dsn = $config['all']['propel']['param']['dsn'];
            $user = $config['all']['propel']['param']['username'];
            $pass = $config['all']['propel']['param']['password'];
            
            $pdo = new \PDO($dsn, $user, $pass);
            $pdo->setAttribute(\PDO::ATTR_ERRMODE, \PDO::ERRMODE_EXCEPTION);
            
            // Check if exists
            $stmt = $pdo->prepare("SELECT id FROM display_object_config WHERE object_id = ?");
            $stmt->execute([$objectId]);
            
            if (!$stmt->fetch()) {
                // Insert new
                $stmt = $pdo->prepare("INSERT INTO display_object_config (object_id, object_type, created_at, updated_at) VALUES (?, 'library', NOW(), NOW())");
                $stmt->execute([$objectId]);
            } else {
                // Update existing
                $stmt = $pdo->prepare("UPDATE display_object_config SET object_type = 'library', updated_at = NOW() WHERE object_id = ?");
                $stmt->execute([$objectId]);
            }
        } catch (\Exception $e) {
            // Log error but don't fail the save
            error_log("Failed to sync display_object_config for object $objectId: " . $e->getMessage());
        }
    }
}
